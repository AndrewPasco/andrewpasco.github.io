<!-- Scrollbar and side progress tracker-->

<!-- Scroll Progress Bar -->
<div id="scrollProgressContainer">
  <div id="scrollProgressBar"></div>
</div>

<style>
/* Smooth scrolling */
html { scroll-behavior: smooth; }

/* Scroll progress bar */
#scrollProgressContainer {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 4px;
  background: #eee;
  z-index: 9999;
}
#scrollProgressBar {
  width: 0%;
  height: 100%;
  background: #0066cc;
}

/* Sidebar */
.sidebar {
  position: fixed;
  top: 100px;
  left: 20px;
  width: 220px;
  padding: 16px;
  background: #f8f8f8;
  border: 1px solid #ddd;
  border-radius: 6px;
  z-index: 1000;
}
.sidebar h3 {
  margin-top: 0;
}
.sidebar ul {
  list-style: none;
  padding: 0;
  margin: 0;
}
.sidebar li {
  margin: 8px 0;
}
.sidebar a {
  text-decoration: none;
  color: #0066cc;
}
.sidebar a:hover {
  text-decoration: underline;
}
.sidebar a.active {
  font-weight: bold;
  color: #ff6600;
}
</style>

<!-- Scripts for sidebar and scroll progress -->
<script>
// Scroll progress bar
window.addEventListener('scroll', function() {
  const scrollTop = window.scrollY;
  const docHeight = document.body.scrollHeight - window.innerHeight;
  const scrollPercent = (scrollTop / docHeight) * 100;
  document.getElementById('scrollProgressBar').style.width = scrollPercent + '%';
});


// Highlight current section in sidebar: WRAP THIS CODE
document.addEventListener('DOMContentLoaded', () => {
    // These selectors are now guaranteed to find the elements
    const sections = document.querySelectorAll('.section-pane');
    const sidebarLinks = document.querySelectorAll('.sidebar a');

    // This check is very helpful for debugging
    if (sections.length === 0 || sidebarLinks.length === 0) {
        console.warn("Sidebar highlighting failed: Could not find all section or sidebar elements.");
        // Stop execution if elements are missing
        return; 
    }

    // Define the scroll event handler function
    const highlightSection = () => {
        let current = '';
        // Use a conservative offset (e.g., 80) to account for fixed header/navbar
        const offset = 80; 

        sections.forEach(section => {
            // Check if the section top is above the current scroll position (minus the offset)
            const sectionTop = section.offsetTop - offset; 
            
            if (window.scrollY >= sectionTop) {
                current = section.getAttribute('id');
            }
        });

        sidebarLinks.forEach(link => {
            link.classList.remove('active');
            // Check if the link's href matches the current section ID
            if (link.getAttribute('href') === '#' + current) {
                link.classList.add('active');
            }
        });
    };

    // 1. Run the function every time the user scrolls
    window.addEventListener('scroll', highlightSection);
    
    // 2. Run the function once immediately when the page loads
    // This sets the correct highlight if the user loads the page mid-scroll
    highlightSection(); 
});
</script>